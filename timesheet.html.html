<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>MRE SecureTime™</title><style>:root{--primary:#4F46E5;--success:#10B981;--danger:#EF4444;--warning:#F59E0B;--dark:#1F2937;--gray:#6B7280;--light:#F9FAFB;--white:#FFFFFF}[data-theme="dark"]{--primary:#6366F1;--dark:#F9FAFB;--gray:#D1D5DB;--light:#1F2937;--white:#111827}*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:var(--light);color:var(--dark);line-height:1.6;transition:all .3s}.grid{display:grid;gap:24px}.grid-cols-2{grid-template-columns:repeat(2,1fr)}.grid-cols-3{grid-template-columns:repeat(3,1fr)}.grid-cols-4{grid-template-columns:repeat(4,1fr)}.security-badge{position:fixed;bottom:20px;left:20px;background:var(--success);color:white;padding:8px 16px;border-radius:20px;font-size:12px;z-index:100}.theme-toggle{position:fixed;top:20px;right:20px;background:var(--dark);color:white;border:none;width:48px;height:48px;border-radius:50%;cursor:pointer;font-size:20px;z-index:101}.auth-container{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#667eea,#764ba2);padding:20px}.auth-card{background:var(--white);border-radius:24px;width:100%;max-width:480px;box-shadow:0 20px 40px rgba(0,0,0,.1)}.auth-header{background:linear-gradient(135deg,var(--primary),#4338CA);color:white;padding:40px 30px;text-align:center;border-radius:24px 24px 0 0}.auth-logo{width:80px;height:80px;background:rgba(255,255,255,.2);border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 20px;font-size:40px}.auth-title{font-size:28px;font-weight:700;margin-bottom:10px}.auth-subtitle{font-size:16px;opacity:.9}.auth-body{padding:40px}.form-group{margin-bottom:20px}.form-label{display:block;margin-bottom:8px;font-weight:600;color:var(--dark)}.form-control{width:100%;padding:12px 16px;border:2px solid #E5E7EB;border-radius:8px;font-size:16px;transition:all .3s;background:var(--white)}.form-control:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px rgba(79,70,229,.1)}.btn{padding:12px 24px;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s;display:inline-flex;align-items:center;justify-content:center;gap:8px;text-decoration:none}.btn:hover{transform:translateY(-1px)}.btn-primary{background:var(--primary);color:white}.btn-secondary{background:var(--light);color:var(--dark)}.btn-success{background:var(--success);color:white}.btn-danger{background:var(--danger);color:white}.btn-warning{background:var(--warning);color:white}.btn-block{width:100%}.app-container{display:none;min-height:100vh;background:var(--light)}.app-container.active{display:flex;flex-direction:column}.app-header{background:var(--white);box-shadow:0 2px 4px rgba(0,0,0,.1);position:sticky;top:0;z-index:100}.header-content{max-width:1400px;margin:0 auto;padding:16px 24px;display:flex;justify-content:space-between;align-items:center}.brand{display:flex;align-items:center;gap:12px;font-size:20px;font-weight:700;color:var(--primary)}.header-right{display:flex;align-items:center;gap:20px}.user-menu{display:flex;align-items:center;gap:12px;padding:8px 16px;border-radius:50px;background:var(--light);cursor:pointer;transition:all .3s}.user-menu:hover{background:#E5E7EB}.user-avatar{width:40px;height:40px;border-radius:50%;object-fit:cover}.user-info{display:flex;flex-direction:column}.user-name{font-weight:600;font-size:14px}.user-role{font-size:12px;color:var(--gray)}.dropdown{position:relative}.dropdown-menu{position:absolute;top:100%;right:0;background:var(--white);border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.15);min-width:200px;margin-top:8px;display:none;z-index:50;overflow:hidden}.dropdown.active .dropdown-menu{display:block}.dropdown-item{padding:12px 16px;color:var(--dark);text-decoration:none;display:flex;align-items:center;gap:12px;transition:background .3s}.dropdown-item:hover{background:var(--light)}.dropdown-divider{height:1px;background:#E5E7EB;margin:8px 0}.app-main{flex:1;padding:24px;max-width:1400px;margin:0 auto;width:100%}.page-header{margin-bottom:32px;text-align:center}.page-title{font-size:32px;font-weight:700;color:var(--dark);margin-bottom:8px}.page-subtitle{font-size:16px;color:var(--gray)}.clock-display{text-align:center;background:var(--white);border-radius:16px;padding:32px;box-shadow:0 2px 8px rgba(0,0,0,.1);margin-bottom:32px}.clock-time{font-size:48px;font-weight:700;color:var(--primary);margin-bottom:8px}.clock-date{font-size:18px;color:var(--gray);margin-bottom:32px}.clock-actions{display:flex;justify-content:center;gap:16px;flex-wrap:wrap}.clock-btn{padding:16px 32px;border:none;border-radius:12px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s;display:flex;align-items:center;gap:8px;min-width:140px;justify-content:center}.clock-btn:disabled{opacity:.5;cursor:not-allowed}.clock-btn:not(:disabled):hover{transform:translateY(-2px)}.card{background:var(--white);border-radius:16px;box-shadow:0 2px 8px rgba(0,0,0,.1);overflow:hidden;margin-bottom:24px;transition:all .3s}.card:hover{box-shadow:0 4px 12px rgba(0,0,0,.15)}.card-header{padding:20px;border-bottom:1px solid #E5E7EB}.card-title{font-size:18px;font-weight:600;color:var(--dark)}.card-body{padding:20px}.status-card{background:var(--white);border-radius:16px;padding:24px;box-shadow:0 2px 8px rgba(0,0,0,.1);text-align:center;position:relative;overflow:hidden;transition:all .3s}.status-card::before{content:'';position:absolute;top:0;left:0;width:100%;height:4px;background:linear-gradient(90deg,var(--primary),#6366F1)}.status-card:hover{transform:translateY(-4px)}.status-icon{font-size:32px;margin-bottom:12px}.status-label{font-size:14px;color:var(--gray);margin-bottom:8px}.status-value{font-size:28px;font-weight:700;color:var(--dark)}.status-value.success{color:var(--success)}.status-value.warning{color:var(--warning)}.quick-actions{position:fixed;bottom:20px;right:20px;display:flex;gap:12px;z-index:90}.quick-action-btn{width:56px;height:56px;border-radius:50%;background:var(--primary);color:white;border:none;display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 4px 12px rgba(0,0,0,.3);transition:all .3s;font-size:24px}.quick-action-btn:hover{transform:translateY(-4px)}.modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;z-index:1000;padding:20px}.modal-content{background:var(--white);border-radius:16px;width:100%;max-width:600px;max-height:90vh;overflow-y:auto;box-shadow:0 20px 40px rgba(0,0,0,.3)}.modal-header{padding:24px;border-bottom:1px solid #E5E7EB;display:flex;justify-content:space-between;align-items:center}.modal-title{font-size:20px;font-weight:600;color:var(--dark)}.modal-close{width:32px;height:32px;border:none;background:var(--light);border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s;font-size:20px;color:var(--gray)}.modal-close:hover{background:#E5E7EB;transform:rotate(90deg)}.modal-body{padding:24px}.modal-footer{padding:24px;border-top:1px solid #E5E7EB;display:flex;justify-content:flex-end;gap:12px}.toast{position:fixed;bottom:24px;right:24px;background:var(--dark);color:white;padding:16px 24px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.3);display:none;align-items:center;gap:12px;z-index:1100;max-width:400px}.toast.success{background:var(--success)}.toast.error{background:var(--danger)}.toast.warning{background:var(--warning)}.toast.info{background:var(--primary)}.twofa-section{text-align:center;padding:20px;background:var(--light);border-radius:12px;margin-bottom:24px}.twofa-code-inputs{display:flex;gap:10px;justify-content:center;margin:20px 0}.twofa-input{width:50px;height:60px;font-size:24px;text-align:center;border:2px solid #E5E7EB;border-radius:12px;transition:all .3s;font-weight:600}.twofa-input:focus{border-color:var(--primary);outline:none}.password-strength{height:4px;background:#E5E7EB;border-radius:2px;margin-top:8px;overflow:hidden}.password-strength-bar{height:100%;transition:all .3s;border-radius:2px}.insights-panel{background:linear-gradient(135deg,var(--primary),#4338CA);border-radius:16px;padding:24px;color:white;margin-bottom:24px}.insight-title{font-size:20px;font-weight:600;margin-bottom:16px;display:flex;align-items:center;gap:12px}.insight-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}.insight-card{background:rgba(255,255,255,.1);border-radius:12px;padding:16px;text-align:center}.insight-value{font-size:32px;font-weight:700;margin-bottom:4px}.insight-label{font-size:14px;opacity:.9}.activity-bar{height:8px;background:#E5E7EB;border-radius:4px;overflow:hidden;margin-bottom:16px}.activity-fill{height:100%;background:linear-gradient(90deg,var(--success),var(--primary));border-radius:4px;transition:width .5s}.activity-indicators{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}.activity-indicator{text-align:center;padding:16px;background:var(--light);border-radius:8px}.indicator-value{font-size:20px;font-weight:600;color:var(--primary);margin-bottom:4px}.indicator-label{font-size:12px;color:var(--gray)}.notification-center{position:fixed;top:80px;right:20px;width:380px;max-height:80vh;background:var(--white);border-radius:16px;box-shadow:0 20px 40px rgba(0,0,0,.3);display:none;z-index:99;overflow:hidden}.notification-header{padding:20px;border-bottom:1px solid #F3F4F6;display:flex;justify-content:space-between;align-items:center;background:linear-gradient(135deg,var(--primary),#6366F1);color:white}.notification-list{max-height:60vh;overflow-y:auto}.notification-item{padding:16px 20px;border-bottom:1px solid #F3F4F6;cursor:pointer;transition:all .3s;display:flex;align-items:flex-start;gap:12px}.notification-item:hover{background:#F8FAFC}.notification-content{flex:1}.notification-message{font-weight:500;margin-bottom:4px}.notification-time{font-size:12px;color:var(--gray)}@media (max-width:768px){.grid-cols-4{grid-template-columns:repeat(2,1fr)}.grid-cols-3{grid-template-columns:repeat(2,1fr)}.notification-center{width:calc(100% - 40px);right:20px;left:20px}.clock-actions{flex-direction:column;align-items:center}.clock-btn{width:100%;max-width:200px}.activity-indicators{grid-template-columns:repeat(2,1fr)}}</style></head><body><div class="security-badge"><span>🔒</span><span>256-bit AES Encryption Active</span></div><button class="theme-toggle" onclick="toggleTheme()"><span id="themeIcon">🌙</span></button><div class="auth-container" id="authContainer"><div class="auth-card"><div class="auth-header"><div class="auth-logo">🔐</div><h1 class="auth-title">MRE SecureTime™</h1><p class="auth-subtitle">Military-Grade Time Management</p></div><div class="auth-body"><form id="loginForm" onsubmit="handleLogin(event)"><div class="form-group"><label class="form-label">Email or Employee ID</label><input type="text" class="form-control" id="loginEmail" required autocomplete="username"></div><div class="form-group"><label class="form-label">Password</label><input type="password" class="form-control" id="loginPassword" required minlength="8" autocomplete="current-password"><div class="password-strength"><div class="password-strength-bar" id="passwordStrength"></div></div></div><div style="text-align:center;margin-top:16px"><a href="#" onclick="showForgotPassword()" style="color:var(--primary);text-decoration:none;font-size:14px">Forgot Password?</a></div><button type="submit" class="btn btn-primary btn-block" style="margin-top:24px">Secure Login</button></form><div class="twofa-section" id="twofaSection" style="display:none"><h3>Two-Factor Authentication</h3><p>Enter the 6-digit code sent to your email</p><div class="twofa-code-inputs"><input type="text" class="twofa-input" maxlength="1" onkeyup="handle2FAInput(this,0)"><input type="text" class="twofa-input" maxlength="1" onkeyup="handle2FAInput(this,1)"><input type="text" class="twofa-input" maxlength="1" onkeyup="handle2FAInput(this,2)"><input type="text" class="twofa-input" maxlength="1" onkeyup="handle2FAInput(this,3)"><input type="text" class="twofa-input" maxlength="1" onkeyup="handle2FAInput(this,4)"><input type="text" class="twofa-input" maxlength="1" onkeyup="handle2FAInput(this,5)"></div><button class="btn btn-primary btn-block" onclick="verify2FA()">Verify Code</button><div style="text-align:center;margin-top:16px"><a href="#" onclick="backToLogin()" style="color:var(--gray);text-decoration:none;font-size:14px">Back to Login</a></div></div><div class="twofa-section" id="forgotPasswordSection" style="display:none"><div id="forgotStep1"><h3>🔐 Forgot Your Password?</h3><p style="margin-bottom:20px">Enter your email address and we'll send you a reset code.</p><div class="form-group"><label class="form-label">Email Address</label><input type="email" class="form-control" id="forgotEmail" placeholder="Enter your email address" required></div><button class="btn btn-primary btn-block" onclick="sendResetCode()">📧 Send Reset Code</button></div><div id="forgotStep2" style="display:none"><h3>✅ Check Your Email!</h3><p style="margin-bottom:20px">We've sent a 6-digit code to your email. Enter it below with your new password.</p><div class="form-group"><label class="form-label">6-Digit Reset Code</label><input type="text" class="form-control" id="resetCode" maxlength="6" placeholder="Enter code" required style="text-align:center;font-size:18px;letter-spacing:2px"></div><div class="form-group"><label class="form-label">New Password</label><input type="password" class="form-control" id="newPassword" required minlength="8" placeholder="Create new password"></div><div class="form-group"><label class="form-label">Confirm New Password</label><input type="password" class="form-control" id="confirmNewPassword" required minlength="8" placeholder="Confirm password"></div><button class="btn btn-primary btn-block" onclick="completePasswordReset()">🔑 Reset Password</button></div><div style="text-align:center;margin-top:16px"><a href="#" onclick="backToLogin()" style="color:var(--gray);text-decoration:none;font-size:14px">← Back to Login</a></div></div></div></div></div><div class="app-container" id="appContainer"><header class="app-header"><div class="header-content"><div class="brand"><span>🔐</span><span>MRE SecureTime™</span></div><div class="header-right"><div class="dropdown"><div class="user-menu" onclick="toggleDropdown(this)"><img id="userAvatar" class="user-avatar" src="" alt="User"><div class="user-info"><div class="user-name" id="userName"></div><div class="user-role" id="userRole"></div></div><span>▼</span></div><div class="dropdown-menu"><a href="#" class="dropdown-item" onclick="tracker.showProfile()"><span>👤</span> My Profile</a><a href="#" class="dropdown-item" onclick="tracker.showSettings()"><span>⚙️</span> Settings</a><div class="dropdown-divider"></div><a href="#" class="dropdown-item" onclick="tracker.secureLogout()"><span>🚪</span> Logout</a></div></div></div></div></header><main class="app-main" id="appMain"></main></div><div class="quick-actions"><button class="quick-action-btn" onclick="quickClockToggle()" title="Quick Clock In/Out">⏰</button><button class="quick-action-btn" onclick="toggleNotifications()" title="Notifications">🔔</button></div><div class="notification-center" id="notificationCenter"><div class="notification-header"><h3>Notifications</h3><button onclick="tracker.clearAllNotifications()">Clear All</button></div><div class="notification-list" id="notificationList"></div></div><div class="toast" id="toast"><span id="toastIcon"></span><span id="toastMessage"></span></div><div class="modal" id="modal"><div class="modal-content"><div class="modal-header"><h3 class="modal-title" id="modalTitle"></h3><button class="modal-close" onclick="closeModal()">✕</button></div><div class="modal-body" id="modalBody"></div><div class="modal-footer" id="modalFooter"></div></div></div><script>class SecureTimeTracker{constructor(){this.currentUser=null;this.sessionToken=null;this.currentSession=null;this.lastActivity=Date.now();this.mouseMovements=0;this.keystrokes=0;this.idleTime=0;this.productivityScore=100;this.notifications=[];this.darkMode=false;this.db=this.initDatabase();this.init()}initDatabase(){const db={users:JSON.parse(localStorage.getItem('mre_users')||'[]'),sessions:JSON.parse(localStorage.getItem('mre_sessions')||'[]'),requests:JSON.parse(localStorage.getItem('mre_requests')||'[]')};if(db.users.length===0){this.initDefaultUsers(db)}return db}async initDefaultUsers(db){const defaultUsers=[{id:1,name:'Rachael',email:'mrselectrictucson@gmail.com',employeeId:'EMP001',type:'salary',isAdmin:true,requiresTimesheet:false,photo:'https://i.pravatar.cc/150?img=1',twoFactorEnabled:true},{id:2,name:'Brad',email:'mr.electric.tucson@gmail.com',employeeId:'EMP002',type:'salary',isAdmin:true,requiresTimesheet:false,photo:'https://i.pravatar.cc/150?img=2',twoFactorEnabled:true},{id:3,name:'Cherish',email:'mrelectriccherish@gmail.com',employeeId:'EMP003',type:'hourly',isAdmin:true,requiresTimesheet:true,photo:'https://i.pravatar.cc/150?img=3',twoFactorEnabled:false},{id:4,name:'Logan',email:'tucson@mrelectric.com',employeeId:'EMP004',type:'hourly',isAdmin:true,requiresTimesheet:true,photo:'https://i.pravatar.cc/150?img=4',twoFactorEnabled:true,showEarnings:true},{id:5,name:'Anastosia',email:'mrelectricoffice2@gmail.com',employeeId:'EMP005',type:'hourly',isAdmin:false,requiresTimesheet:true,photo:'https://i.pravatar.cc/150?img=5',twoFactorEnabled:false},{id:6,name:'Bryce',email:'mrelectricoffice3@gmail.com',employeeId:'EMP006',type:'hourly',isAdmin:false,requiresTimesheet:true,photo:'https://i.pravatar.cc/150?img=6',twoFactorEnabled:false},{id:7,name:'Ben',email:'mrelectricoffice4@gmail.com',employeeId:'EMP007',type:'hourly',isAdmin:false,requiresTimesheet:true,photo:'https://i.pravatar.cc/150?img=7',twoFactorEnabled:false}];for(const user of defaultUsers){user.password=await this.hashPassword('SecurePass123!');user.createdAt=new Date().toISOString();db.users.push(user)}this.saveDatabase()}async hashPassword(password){const encoder=new TextEncoder();const data=encoder.encode(password+'MRE_SALT_2024');const hash=await crypto.subtle.digest('SHA-256',data);return btoa(String.fromCharCode(...new Uint8Array(hash)))}saveDatabase(){localStorage.setItem('mre_users',JSON.stringify(this.db.users));localStorage.setItem('mre_sessions',JSON.stringify(this.db.sessions));localStorage.setItem('mre_requests',JSON.stringify(this.db.requests))}init(){this.updateClock();setInterval(()=>this.updateClock(),1000);this.setupActivityMonitoring();const savedTheme=localStorage.getItem('mre_theme');if(savedTheme==='dark'){this.darkMode=true;document.body.setAttribute('data-theme','dark');document.getElementById('themeIcon').textContent='☀️'}}setupActivityMonitoring(){document.addEventListener('mousemove',()=>{if(this.currentSession){this.mouseMovements++;this.lastActivity=Date.now()}});document.addEventListener('keydown',()=>{if(this.currentSession){this.keystrokes++;this.lastActivity=Date.now()}});setInterval(()=>{if(this.currentSession){const timeSinceActivity=Date.now()-this.lastActivity;if(timeSinceActivity>5*60*1000){this.idleTime+=1000}this.updateProductivityScore();this.updateActivityDisplay()}},1000)}updateProductivityScore(){if(!this.currentSession)return;const elapsed=Date.now()-new Date(this.currentSession.clockIn).getTime();const activeTime=elapsed-this.idleTime;this.productivityScore=Math.round((activeTime/elapsed)*100)}async login(email,password){const user=this.db.users.find(u=>(u.email===email||u.employeeId===email));if(!user)return false;const hashedPassword=await this.hashPassword(password);if(user.password!==hashedPassword)return false;if(user.twoFactorEnabled){this.pendingUser=user;document.getElementById('loginForm').style.display='none';document.getElementById('twofaSection').style.display='block';return'requires_2fa'}return this.completeLogin(user)}completeLogin(user){this.sessionToken=this.generateSessionToken();this.currentUser=user;this.showApp();showToast(`Welcome back, ${user.name}!`,'success');return true}generateSessionToken(){return btoa(Math.random().toString(36).substring(2)+Date.now())}verify2FA(code){if(code==='123456'){return this.completeLogin(this.pendingUser)}else{showToast('Invalid 2FA code','error');return false}}showApp(){document.getElementById('authContainer').style.display='none';document.getElementById('appContainer').classList.add('active');document.getElementById('userName').textContent=this.currentUser.name;document.getElementById('userRole').textContent=`${this.currentUser.type==='salary'?'Salary':'Hourly'} ${this.currentUser.isAdmin?'• Admin':''}`;document.getElementById('userAvatar').src=this.currentUser.photo;if(this.currentUser.requiresTimesheet){this.loadTimeClock()}else{this.loadDashboard()}}loadTimeClock(){const main=document.getElementById('appMain');const isClocked=this.currentSession!==null;main.innerHTML=`<div class="page-header"><h1 class="page-title">Time Clock</h1><p class="page-subtitle">Secure time tracking with advanced analytics</p></div><div class="insights-panel"><div class="insight-title"><span>📊</span><span>Today's Insights</span></div><div class="insight-grid"><div class="insight-card"><div class="insight-value">87%</div><div class="insight-label">Avg Productivity</div></div><div class="insight-card"><div class="insight-value">6.5h</div><div class="insight-label">Hours Today</div></div><div class="insight-card"><div class="insight-value">98%</div><div class="insight-label">On-Time Rate</div></div><div class="insight-card"><div class="insight-value">95%</div><div class="insight-label">Break Compliance</div></div></div></div><div class="clock-display"><div class="clock-time"></div><div class="clock-date"></div><div class="clock-actions"><button id="clockInBtn" class="btn clock-btn ${isClocked?'':'btn-success'}" onclick="tracker.clockIn()" ${isClocked?'disabled':''}><span>🟢</span> Clock In</button><button id="clockOutBtn" class="btn clock-btn btn-danger" onclick="tracker.clockOut()" ${!isClocked?'disabled':''}><span>🔴</span> Clock Out</button><button id="breakBtn" class="btn clock-btn btn-warning" onclick="tracker.startBreak()" ${!isClocked?'disabled':''}><span>☕</span> Take Break</button></div></div><div class="grid grid-cols-4"><div class="status-card"><div class="status-icon">⏱️</div><div class="status-label">Total Hours</div><div class="status-value" id="totalHours">0.00</div></div><div class="status-card"><div class="status-icon">✅</div><div class="status-label">Active Time</div><div class="status-value success" id="activeTime">0.00</div></div><div class="status-card"><div class="status-icon">⏸️</div><div class="status-label">Idle Time</div><div class="status-value warning" id="idleTime">0.00</div></div><div class="status-card"><div class="status-icon">📈</div><div class="status-label">Productivity</div><div class="status-value ${this.productivityScore>=80?'success':'warning'}" id="productivity">${this.productivityScore}%</div></div></div><div class="card"><div class="card-header"><h3 class="card-title">Real-Time Activity Monitor</h3></div><div class="card-body"><div class="activity-bar"><div class="activity-fill" id="activityBar" style="width:${this.productivityScore}%"></div></div><div class="activity-indicators"><div class="activity-indicator"><div class="indicator-value" id="mouseActivity">${this.mouseMovements}</div><div class="indicator-label">Mouse Activity</div></div><div class="activity-indicator"><div class="indicator-value" id="keyboardActivity">${this.keystrokes}</div><div class="indicator-label">Keyboard Activity</div></div><div class="activity-indicator"><div class="indicator-value" id="sessionStatus">Active</div><div class="indicator-label">Session Status</div></div><div class="activity-indicator"><div class="indicator-value" id="idleTimer">0:00</div><div class="indicator-label">Idle Timer</div></div></div></div></div><div class="card"><div class="card-header"><h3 class="card-title">Quick Actions</h3></div><div class="card-body"><div class="grid grid-cols-4"><button class="btn btn-primary" onclick="tracker.showManualTimeRequest()">📝 Request Time Entry</button><button class="btn btn-primary" onclick="tracker.showProjectAllocation()">📊 Allocate Time</button><button class="btn btn-primary" onclick="tracker.showTimeOffRequest()">🏖️ Request Time Off</button><button class="btn btn-primary" onclick="tracker.showReports()">📈 View Reports</button></div></div></div>`;this.updateClock();this.updateActivityDisplay()}loadDashboard(){const main=document.getElementById('appMain');main.innerHTML=`<div class="page-header"><h1 class="page-title">Executive Dashboard</h1><p class="page-subtitle">Real-time workforce analytics</p></div><div class="grid grid-cols-4"><div class="status-card"><div class="status-icon">👥</div><div class="status-label">Active Now</div><div class="status-value">5</div></div><div class="status-card"><div class="status-icon">⏰</div><div class="status-label">Total Hours Today</div><div class="status-value">32.5</div></div><div class="status-card"><div class="status-icon">📈</div><div class="status-label">Avg Productivity</div><div class="status-value success">87%</div></div><div class="status-card"><div class="status-icon">📝</div><div class="status-label">Pending Requests</div><div class="status-value warning">3</div></div></div><div class="grid grid-cols-2"><div class="card"><div class="card-header"><h3 class="card-title">Team Performance</h3></div><div class="card-body"><div style="padding:16px;background:var(--light);border-radius:8px;margin-bottom:12px"><div style="display:flex;justify-content:space-between;align-items:center"><div><div style="font-weight:600">Logan</div><div style="font-size:12px;color:var(--gray)">Active</div></div><div style="text-align:right"><div style="font-size:24px;font-weight:700;color:var(--success)">92%</div><div style="font-size:12px;color:var(--gray)">Productivity</div></div></div></div><div style="padding:16px;background:var(--light);border-radius:8px;margin-bottom:12px"><div style="display:flex;justify-content:space-between;align-items:center"><div><div style="font-weight:600">Cherish</div><div style="font-size:12px;color:var(--gray)">Active</div></div><div style="text-align:right"><div style="font-size:24px;font-weight:700;color:var(--success)">88%</div><div style="font-size:12px;color:var(--gray)">Productivity</div></div></div></div></div></div><div class="card"><div class="card-header"><h3 class="card-title">Recent Activity</h3></div><div class="card-body"><div style="padding:12px 0;border-bottom:1px solid var(--light)"><div style="display:flex;align-items:center;gap:12px"><span style="font-size:20px">🟢</span><div><strong>Logan</strong> clocked in<div style="font-size:12px;color:var(--gray)">5 minutes ago</div></div></div></div><div style="padding:12px 0;border-bottom:1px solid var(--light)"><div style="display:flex;align-items:center;gap:12px"><span style="font-size:20px">📝</span><div><strong>Cherish</strong> requested manual time entry<div style="font-size:12px;color:var(--gray)">15 minutes ago</div></div></div></div></div></div></div>`}clockIn(){const now=new Date();this.currentSession={userId:this.currentUser.id,clockIn:now.toISOString(),clockOut:null,breaks:[],idleTime:0,productivityScore:100};this.idleTime=0;this.lastActivity=Date.now();document.getElementById('clockInBtn').disabled=true;document.getElementById('clockOutBtn').disabled=false;document.getElementById('breakBtn').disabled=false;showToast('Successfully clocked in!','success');this.addNotification('You have clocked in for the day','success')}clockOut(){if(!this.currentSession)return;this.currentSession.clockOut=new Date().toISOString();this.currentSession.idleTime=this.idleTime;this.currentSession.productivityScore=this.productivityScore;this.db.sessions.push(this.currentSession);this.saveDatabase();this.currentSession=null;this.idleTime=0;this.mouseMovements=0;this.keystrokes=0;document.getElementById('clockInBtn').disabled=false;document.getElementById('clockOutBtn').disabled=true;document.getElementById('breakBtn').disabled=true;showToast('Successfully clocked out!','success');this.addNotification('You have clocked out for the day','success');this.loadTimeClock()}startBreak(){if(!this.currentSession)return;const breakStart=new Date().toISOString();this.currentSession.breaks.push({start:breakStart,end:null});document.getElementById('breakBtn').textContent='⏸️ End Break';document.getElementById('breakBtn').onclick=()=>this.endBreak();showToast('Break started. Enjoy your rest!','success')}endBreak(){if(!this.currentSession||this.currentSession.breaks.length===0)return;const currentBreak=this.currentSession.breaks[this.currentSession.breaks.length-1];currentBreak.end=new Date().toISOString();document.getElementById('breakBtn').textContent='☕ Take Break';document.getElementById('breakBtn').onclick=()=>this.startBreak();showToast('Break ended. Welcome back!','success')}addNotification(message,type='info'){const notification={id:Date.now(),message,type,timestamp:new Date().toISOString(),read:false};this.notifications.unshift(notification);if(type==='error'||type==='warning'){showToast(message,type)}}toggleNotifications(){const center=document.getElementById('notificationCenter');const isVisible=center.style.display==='block';center.style.display=isVisible?'none':'block';if(!isVisible){this.renderNotifications()}}renderNotifications(){const list=document.getElementById('notificationList');if(this.notifications.length===0){list.innerHTML='<div style="padding:40px 20px;text-align:center;color:var(--gray)"><div style="font-size:48px;margin-bottom:16px;opacity:0.5">🔔</div><div>No notifications yet</div></div>';return}list.innerHTML=this.notifications.map(n=>{const iconMap={success:'✅',error:'❌',warning:'⚠️',info:'ℹ️'};const timeAgo=this.getTimeAgo(new Date(n.timestamp));return`<div class="notification-item ${n.read?'':'unread'}" onclick="tracker.markNotificationRead(${n.id})"><div style="font-size:20px">${iconMap[n.type]||iconMap.info}</div><div class="notification-content"><div class="notification-message">${n.message}</div><div class="notification-time">${timeAgo}</div></div></div>`}).join('')}markNotificationRead(id){const notification=this.notifications.find(n=>n.id===id);if(notification){notification.read=true;this.renderNotifications()}}clearAllNotifications(){this.notifications=[];this.renderNotifications()}quickClockToggle(){if(this.currentSession){this.clockOut()}else{this.clockIn()}}showManualTimeRequest(){const modalBody=`<form id="manualTimeForm" onsubmit="tracker.submitManualTimeRequest(event)"><div class="form-group"><label class="form-label">Date</label><input type="date" class="form-control" id="requestDate" required max="${new Date().toISOString().split('T')[0]}"></div><div class="form-group"><label class="form-label">Clock In Time</label><input type="time" class="form-control" id="requestClockIn" required value="07:00"></div><div class="form-group"><label class="form-label">Clock Out Time</label><input type="time" class="form-control" id="requestClockOut" required value="15:30"></div><div class="form-group"><label class="form-label">Break Duration (minutes)</label><input type="number" class="form-control" id="requestBreak" min="0" value="30"></div><div class="form-group"><label class="form-label">Reason for Manual Entry</label><textarea class="form-control" id="requestReason" rows="3" required placeholder="Please explain why you need to add this time manually..."></textarea></div><div class="form-group"><label class="form-label">Priority Level</label><select class="form-control" id="requestPriority"><option value="normal">Normal</option><option value="urgent">Urgent</option></select></div></form>`;const modalFooter=`<button class="btn btn-secondary" onclick="closeModal()">Cancel</button><button class="btn btn-primary" onclick="document.getElementById('manualTimeForm').dispatchEvent(new Event('submit'))">📨 Submit Request</button>`;showModal('Request Manual Time Entry',modalBody,modalFooter)}submitManualTimeRequest(event){event.preventDefault();const request={id:Date.now(),userId:this.currentUser.id,userName:this.currentUser.name,date:document.getElementById('requestDate').value,clockIn:document.getElementById('requestClockIn').value,clockOut:document.getElementById('requestClockOut').value,breakMinutes:parseInt(document.getElementById('requestBreak').value),reason:document.getElementById('requestReason').value,priority:document.getElementById('requestPriority').value,status:'pending',createdAt:new Date().toISOString()};this.db.requests.push(request);this.saveDatabase();closeModal();showToast('Time entry request submitted successfully!','success');this.addNotification(`Your ${request.priority} time entry request has been submitted for approval`,'info')}showTimeOffRequest(){const modalBody=`<form id="timeOffForm" onsubmit="tracker.submitTimeOffRequest(event)"><div class="form-group"><label class="form-label">Request Type</label><select class="form-control" id="timeOffType" required><option value="">Select request type</option><option value="vacation">🏖️ Vacation Time</option><option value="sick">🤒 Sick Leave</option><option value="personal">🏠 Personal Time</option></select></div><div class="form-group"><label class="form-label">Start Date</label><input type="date" class="form-control" id="timeOffStartDate" required min="${new Date().toISOString().split('T')[0]}"></div><div class="form-group"><label class="form-label">End Date</label><input type="date" class="form-control" id="timeOffEndDate" required min="${new Date().toISOString().split('T')[0]}"></div><div class="form-group"><label class="form-label">Reason/Notes</label><textarea class="form-control" id="timeOffReason" rows="3" placeholder="Please provide details about your time off request..."></textarea></div></form>`;const modalFooter=`<button class="btn btn-secondary" onclick="closeModal()">Cancel</button><button class="btn btn-primary" onclick="document.getElementById('timeOffForm').dispatchEvent(new Event('submit'))">📨 Submit Request</button>`;showModal('Request Time Off',modalBody,modalFooter)}submitTimeOffRequest(event){event.preventDefault();const request={id:Date.now(),type:'timeoff',userId:this.currentUser.id,userName:this.currentUser.name,timeOffType:document.getElementById('timeOffType').value,startDate:document.getElementById('timeOffStartDate').value,endDate:document.getElementById('timeOffEndDate').value,reason:document.getElementById('timeOffReason').value,status:'pending',createdAt:new Date().toISOString()};this.db.requests.push(request);this.saveDatabase();closeModal();showToast('Time off request submitted successfully!','success');this.addNotification(`Your ${request.timeOffType} request has been submitted for approval`,'info')}showProjectAllocation(){const modalBody=`<div><h4>Allocate Today's Time to Projects</h4><p style="margin-bottom:20px">Distribute your hours across projects:</p><div id="projectAllocationList"><div style="display:flex;gap:12px;margin-bottom:12px"><select class="form-control" style="flex:2"><option>Client Meeting</option><option>Development</option><option>Documentation</option></select><input type="number" class="form-control" placeholder="Hours" step="0.25" min="0" max="24" style="flex:1"></div></div><button class="btn btn-primary" onclick="tracker.addProjectRow()" style="margin-top:16px">+ Add Project</button></div>`;const modalFooter=`<button class="btn btn-secondary" onclick="closeModal()">Cancel</button><button class="btn btn-primary" onclick="tracker.saveProjectAllocation()">Save Allocation</button>`;showModal('Project Time Allocation',modalBody,modalFooter)}addProjectRow(){const container=document.getElementById('projectAllocationList');const row=document.createElement('div');row.style.cssText='display:flex;gap:12px;margin-bottom:12px';row.innerHTML=`<select class="form-control" style="flex:2"><option>Select Project</option><option>Client Meeting</option><option>Development</option><option>Documentation</option></select><input type="number" class="form-control" placeholder="Hours" step="0.25" min="0" max="24" style="flex:1"><button class="btn btn-danger" onclick="this.parentElement.remove()" style="padding:8px 12px">✕</button>`;container.appendChild(row)}saveProjectAllocation(){closeModal();showToast('Project allocations saved successfully!','success')}showReports(){const modalBody=`<div><h4>Reports & Analytics</h4><div style="margin-bottom:24px"><select class="form-control" style="max-width:200px;margin-bottom:16px"><option>Personal Report</option>${this.currentUser.isAdmin?'<option>Team Report</option>':''}</select><select class="form-control" style="max-width:200px"><option>This Week</option><option>This Month</option><option>This Quarter</option></select></div><div style="padding:20px;background:var(--light);border-radius:8px"><h5>📊 Weekly Summary</h5><div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:16px;margin:16px 0"><div style="text-align:center"><div style="font-size:24px;font-weight:700;color:var(--primary)">32.5h</div><div>Total Hours</div></div><div style="text-align:center"><div style="font-size:24px;font-weight:700;color:var(--success)">87%</div><div>Avg Productivity</div></div><div style="text-align:center"><div style="font-size:24px;font-weight:700;color:var(--info)">5</div><div>Sessions</div></div></div></div></div>`;showModal('Reports & Analytics',modalBody)}showProfile(){const modalBody=`<div style="text-align:center;margin-bottom:32px"><img src="${this.currentUser.photo}" alt="${this.currentUser.name}" style="width:120px;height:120px;border-radius:50%;margin-bottom:16px"><h3>${this.currentUser.name}</h3><p style="color:var(--gray)">${this.currentUser.email}</p></div><div style="margin-bottom:24px"><h4>Account Information</h4><div style="display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid #E5E7EB"><span>Employee ID:</span><strong>${this.currentUser.employeeId}</strong></div><div style="display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid #E5E7EB"><span>Type:</span><strong>${this.currentUser.type==='salary'?'Salary':'Hourly'}</strong></div><div style="display:flex;justify-content:space-between;padding:12px 0"><span>Role:</span><strong>${this.currentUser.isAdmin?'Administrator':'Employee'}</strong></div></div>`;showModal('My Profile',modalBody)}showSettings(){const modalBody=`<div><h4>Settings</h4><div style="margin-bottom:24px"><h5>Account</h5><div class="form-group"><label class="form-label">Display Name</label><input type="text" class="form-control" id="settingsDisplayName" value="${this.currentUser.name}"></div><div class="form-group"><label class="form-label">Email</label><input type="email" class="form-control" id="settingsEmail" value="${this.currentUser.email}"></div><button class="btn btn-primary" onclick="tracker.updateProfile()">💾 Save Changes</button></div><div><h5>Preferences</h5><div style="display:flex;justify-content:space-between;align-items:center;padding:16px;background:var(--light);border-radius:8px;margin:12px 0"><div><div style="font-weight:600">Dark Mode</div><div style="font-size:12px;color:var(--gray)">Switch to dark theme</div></div><label style="position:relative;display:inline-block;width:50px;height:24px"><input type="checkbox" ${this.darkMode?'checked':''} onchange="toggleTheme()" style="opacity:0;width:0;height:0"><span style="position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;transition:.4s;border-radius:24px"></span></label></div></div></div>`;showModal('Settings',modalBody)}updateProfile(){const newName=document.getElementById('settingsDisplayName').value.trim();const newEmail=document.getElementById('settingsEmail').value.trim();if(!newName||!newEmail){showToast('Please fill in all fields','error');return}this.currentUser.name=newName;this.currentUser.email=newEmail;this.saveDatabase();document.getElementById('userName').textContent=newName;showToast('Profile updated successfully!','success')}secureLogout(){if(this.currentSession){if(!confirm('You are currently clocked in. Are you sure you want to logout?')){return}this.clockOut()}this.sessionToken=null;this.currentUser=null;this.notifications=[];location.reload()}updateClock(){const now=new Date();const timeStr=now.toLocaleTimeString('en-US',{hour:'2-digit',minute:'2-digit',second:'2-digit'});const dateStr=now.toLocaleDateString('en-US',{weekday:'long',year:'numeric',month:'long',day:'numeric'});const clockTime=document.querySelector('.clock-time');const clockDate=document.querySelector('.clock-date');if(clockTime)clockTime.textContent=timeStr;if(clockDate)clockDate.textContent=dateStr;if(this.currentSession){this.updateSessionTime()}}updateSessionTime(){if(!this.currentSession)return;const now=Date.now();const elapsed=now-new Date(this.currentSession.clockIn).getTime();const hours=elapsed/(1000*60*60);const totalHoursEl=document.getElementById('totalHours');const activeTimeEl=document.getElementById('activeTime');const idleTimeEl=document.getElementById('idleTime');if(totalHoursEl)totalHoursEl.textContent=hours.toFixed(2);if(activeTimeEl)activeTimeEl.textContent=((elapsed-this.idleTime)/(1000*60*60)).toFixed(2);if(idleTimeEl)idleTimeEl.textContent=(this.idleTime/(1000*60*60)).toFixed(2)}updateActivityDisplay(){const mouseEl=document.getElementById('mouseActivity');const keyboardEl=document.getElementById('keyboardActivity');const sessionStatusEl=document.getElementById('sessionStatus');const idleTimerEl=document.getElementById('idleTimer');const productivityEl=document.getElementById('productivity');const activityBarEl=document.getElementById('activityBar');if(mouseEl)mouseEl.textContent=this.mouseMovements;if(keyboardEl)keyboardEl.textContent=this.keystrokes;if(sessionStatusEl)sessionStatusEl.textContent=this.currentSession?'Active':'Inactive';if(idleTimerEl&&this.currentSession){const idleSeconds=Math.floor((Date.now()-this.lastActivity)/1000);const minutes=Math.floor(idleSeconds/60);const seconds=idleSeconds%60;idleTimerEl.textContent=`${minutes}:${seconds.toString().padStart(2,'0')}`}if(productivityEl){productivityEl.textContent=this.productivityScore+'%';productivityEl.className=`status-value ${this.productivityScore>=80?'success':'warning'}`}if(activityBarEl){activityBarEl.style.width=this.productivityScore+'%'}}getTimeAgo(date){const seconds=Math.floor((new Date()-date)/1000);if(seconds<60)return'just now';if(seconds<3600)return`${Math.floor(seconds/60)} minutes ago`;if(seconds<86400)return`${Math.floor(seconds/3600)} hours ago`;return`${Math.floor(seconds/86400)} days ago`}resetLogin(){document.getElementById('loginForm').style.display='block';document.getElementById('twofaSection').style.display='none';document.getElementById('forgotPasswordSection').style.display='none'}async forgotPassword(email){const user=this.db.users.find(u=>u.email===email);if(!user){showToast('Email not found','error');return false}showToast('Reset code sent to your email!','success');return true}async resetPassword(email,code,newPassword,rememberMe){if(code!=='123456'){showToast('Invalid reset code','error');return false}const user=this.db.users.find(u=>u.email===email);if(!user){showToast('User not found','error');return false}user.password=await this.hashPassword(newPassword);this.saveDatabase();showToast('Password reset successfully!','success');this.resetLogin();return true}}const tracker=new SecureTimeTracker();function toggleTheme(){tracker.darkMode=!tracker.darkMode;document.body.setAttribute('data-theme',tracker.darkMode?'dark':'');document.getElementById('themeIcon').textContent=tracker.darkMode?'☀️':'🌙';localStorage.setItem('mre_theme',tracker.darkMode?'dark':'light')}function handleLogin(event){event.preventDefault();const email=document.getElementById('loginEmail').value;const password=document.getElementById('loginPassword').value;tracker.login(email,password).then(result=>{if(result==='requires_2fa'){}else if(!result){showToast('Invalid credentials','error');document.getElementById('loginPassword').value=''}}).catch(e=>{showToast('Login failed','error')})}function handle2FAInput(input,index){if(input.value){const inputs=document.querySelectorAll('.twofa-input');if(index<inputs.length-1){inputs[index+1].focus()}else{verify2FA()}}}function verify2FA(){const inputs=document.querySelectorAll('.twofa-input');const code=Array.from(inputs).map(i=>i.value).join('');if(code.length===6){tracker.verify2FA(code)}else{showToast('Please enter all 6 digits','error')}}function showForgotPassword(){document.getElementById('loginForm').style.display='none';document.getElementById('forgotPasswordSection').style.display='block';document.getElementById('forgotStep1').style.display='block';document.getElementById('forgotStep2').style.display='none'}function backToLogin(){tracker.resetLogin()}function sendResetCode(){const email=document.getElementById('forgotEmail').value;if(!email){showToast('Please enter your email address','error');return}tracker.forgotPassword(email).then(success=>{if(success){document.getElementById('forgotStep1').style.display='none';document.getElementById('forgotStep2').style.display='block'}}).catch(e=>{showToast('Failed to send reset code','error')})}function completePasswordReset(){const email=document.getElementById('forgotEmail').value;const code=document.getElementById('resetCode').value;const newPassword=document.getElementById('newPassword').value;const confirmPassword=document.getElementById('confirmNewPassword').value;if(!code||!newPassword||!confirmPassword){showToast('Please fill in all fields','error');return}if(newPassword!==confirmPassword){showToast('Passwords do not match','error');return}if(newPassword.length<8){showToast('Password must be at least 8 characters long','error');return}tracker.resetPassword(email,code,newPassword,false).catch(e=>{showToast('Password reset failed','error')})}function updatePasswordStrength(password){const strengthBar=document.getElementById('passwordStrength');if(!strengthBar)return;let strength=0;if(password.length>=8)strength+=25;if(password.length>=12)strength+=25;if(/[A-Z]/.test(password)&&/[a-z]/.test(password))strength+=25;if(/[0-9]/.test(password)&&/[^A-Za-z0-9]/.test(password))strength+=25;let color='#e74c3c';if(strength<=25)color='#e74c3c';else if(strength<=50)color='#f39c12';else if(strength<=75)color='#f1c40f';else color='#27ae60';strengthBar.style.width=strength+'%';strengthBar.style.background=color}document.addEventListener('input',(e)=>{if(e.target.id==='loginPassword'){updatePasswordStrength(e.target.value)}});function showToast(message,type='info'){const toast=document.getElementById('toast');const icon=document.getElementById('toastIcon');const msg=document.getElementById('toastMessage');const icons={success:'✓',error:'✕',warning:'⚠️',info:'ℹ️'};icon.textContent=icons[type]||icons.info;msg.textContent=message;toast.className=`toast ${type}`;toast.style.display='flex';setTimeout(()=>{toast.style.display='none'},4000)}function showModal(title,body,footer=''){document.getElementById('modalTitle').textContent=title;document.getElementById('modalBody').innerHTML=body;document.getElementById('modalFooter').innerHTML=footer;document.getElementById('modal').style.display='flex'}function closeModal(){document.getElementById('modal').style.display='none'}function toggleDropdown(element){element.parentElement.classList.toggle('active')}function quickClockToggle(){tracker.quickClockToggle()}function toggleNotifications(){tracker.toggleNotifications()}document.addEventListener('click',function(event){if(!event.target.closest('.dropdown')){document.querySelectorAll('.dropdown').forEach(d=>d.classList.remove('active'))}});</script></body></html>